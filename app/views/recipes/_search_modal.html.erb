
  <%# Si il y a une recherche, ça construit la modal et ça l'affiche grace au controller stimulus search_modal %>
  <div data-controller="search-modal" id="myModal" class="modal" tabindex="-1" data-search-modal-target="modal">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content rounded">

        <%# Header du modal avec le nombre de résultats %>
        <div class="modal-header bg-success">
          <% if @searched_recipes.empty? %>
            <h2 class="modal-title">No results</h2>
          <% else %>
            <h2 class="modal-title"><%= @searched_recipes.count %> result<%= "s" if @searched_recipes.count > 1 %></h2>
          <% end %>
        </div>

        <%# Body du modal avec iteration de l'array searched_recipes qui regroupe les recettes recherchées %>
        <div class="modal-body modal-body-height d-block pb-0 bg-success">

          <%# Si pas de résultat affiche un logo et no result found %>
          <% if @searched_recipes.empty? %>
            <div class="d-flex justify-content-around" style="margin-top:20vh">
              <div>
                <div class="d-flex justify-content-around">
                  <%= render inline: Rails.root.join('app/assets/images/no_result.svg').read %>
                </div>
                <h1>No results found...</h1>
              </div>
            </div>
          <% end %>

          <% @searched_recipes.each do |recipe| %>

            <%# bouton bookmark %>
            <div class="recipe-card-relative"
               id="bookmarks"
               data-controller="bookmarks"
               data-user-id="<%= current_user.id %>"
               data-bookmarked-by="<%= recipe.bookmarked_by.pluck(:id).to_json %>">
              <!-- Icône de favori -->
              <% if bookmark_exists_for_recipe?(recipe) %>
                <%# <h1>verif fav existe</h1> %>
                <a class="bookmark-button bookmark-active"
                    data-bookmarks-target="bookmarkButton"
                    data-action="click->bookmarks#isBookmark"
                    data-recipe-id="<%= recipe.id %>">
                </a>
              <% else %>
                <%# <h1>verif fav n'existe pas</h1> %>
                <a class="bookmark-button bookmark-inactive"
                    data-bookmarks-target="bookmarkButton"
                    data-action="click->bookmarks#isBookmark"
                    data-recipe-id="<%= recipe.id %>">
                </a>
              <% end %>
            </div>


          <div class="mb-4 <%= UserRecipe.where(recipe_id: recipe.id, user_id: current_user.id).exists? ? "golden-border" : "shadow-sm rounded-10" %>">
            <%= link_to recipe_path(recipe), class: "recipe-card-link" do %>
              <%# image %>
              <div>
                <%= cl_image_tag recipe.photo.key, class: "recipe-show-img rounded-10-top" %>
              </div>
            <% end %>

              <%# informations %>
              <div class="rounded-10-bottom bg-info p-3">
                <%# nom de la recette %>
                <h3><%= recipe.name %></h1>

                <%# pays et XP %>
                <div class="d-flex justify-content-between">
                  <%# drapeau et nom du pays %>
                  <h5><span class="fi <%= recipe.country.flag %>"></span> <%= recipe.country.name.capitalize %></h5>

                  <%# xp et checkmark si recette deja réalisée %>
                  <% if UserRecipe.where(recipe_id: recipe.id, user_id: current_user.id).exists? %>
                    <div class="d-flex">
                      <h5 style="color: rgba(0,0,0,0.4)"><s><%= recipe.xp %>XP</s></h5>
                      <div class="check-circle">✓</div>
                    </div>
                  <% else %>
                    <h5><%= recipe.xp %>XP</h5>
                  <% end %>
                </div>

                <%# difficulté %>
                <div class="d-flex">
                  <% difficulty = recipe.difficulty %>
                  <% if difficulty == "hard" %>
                    <%= image_tag("hard.png", size: "24") %>
                  <% elsif difficulty == "medium" %>
                    <%= image_tag("mid.png", size: "24") %>
                  <% else %>
                    <%= image_tag("ezz.png", size: "24") %>
                  <% end %>
                  <h5 class="ms-2"><%= recipe.difficulty.capitalize %></h5>
                </div>

                <%# preptime %>
                <h5><i class="fa-regular fa-clock"></i> <%= recipe.min_to_h %></h5>

                <%# keywords %>
                <% recipe.keyword_list.each do |keyword| %>
                  <a href="/recipes?query=<%= keyword %>"><h5 class="keyword <%= "kw-" + keyword %>"><%= keyword.capitalize %></h5></a>
                <% end %>
              </div>
            </div>

          <% end %>
        </div>

        <%# petite barre blanche en bas %>
        <div class="modal-footer bg-success"></div>

        <%# Bouton pour fermer le modal %>
        <div class="d-inline-block mx-auto">
          <button type="button" class="bouton-close mt-4" data-bs-dismiss="modal">Close</button>
        </div>

      </div>
    </div>
  </div>
